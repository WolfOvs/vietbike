(this.webpackJsonproot=this.webpackJsonproot||[]).push([[5],{573:function(e,t,a){"use strict";a.r(t);var n=a(8),i=a(0),o=a.n(i),r=a(90),c=a(52),l=a(70),s=a(76),u=a(2),m=a(1);function d(){var e=Object(u.a)(["\n    font-size: 20px;\n    font-weight: bold;\n"]);return d=function(){return e},e}function p(){var e=Object(u.a)(["\n    margin: 40px 40px;\n"]);return p=function(){return e},e}function h(){var e=Object(u.a)(["\n    width: 100%;\n"]);return h=function(){return e},e}function b(){var e=Object(u.a)(["\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 20px 0px 40px 0px;\n    //margin-top: 120px;\n    align-items: center;\n    max-height: 150px;\n    height: 95px;\n    margin: 20px 0px;\n"]);return b=function(){return e},e}function f(){var e=Object(u.a)(["\n    margin-right: 10px;\n    font-size: 18px;\n"]);return f=function(){return e},e}function g(){var e=Object(u.a)(["\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n\n    button {\n        margin-left: 5px;\n    }\n"]);return g=function(){return e},e}function D(){var e=Object(u.a)(["\n    padding: 0px 30px;\n"]);return D=function(){return e},e}function v(){var e=Object(u.a)(["\n    display: flex;\n    justify-content: space-between;\n    position: sticky;\n    top: 0;\n    //width: 89%;\n    background-image: linear-gradient(to bottom, #052232 85%, transparent 109%);\n    padding: 37px 30px 25px 30px;\n    z-index: 99;\n\n"]);return v=function(){return e},e}function w(){var e=Object(u.a)(["\n    // padding: 0px 30px 37px 30px;\n    padding-bottom:37px;\n    width: 100%;\n    overflow-y: auto;\n    overlow-x: hidden;\n\n    &::-webkit-scrollbar {\n        width: 10px;\n        z-index: 9999;\n    }\n\n    &::-webkit-scrollbar-thumb {\n        background-color: ",";\n      }\n"]);return w=function(){return e},e}function x(){var e=Object(u.a)(["\n\tposition: relative;\n\twidth: 100px;\n\tleft: 0;\n\tbackground-color: ",";\n\tdiplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n    padding: 40px 0px;\n"]);return x=function(){return e},e}function O(){var e=Object(u.a)(["\n    display: flex;\n    height: 100%;\n    background-color:",";\n"]);return O=function(){return e},e}function j(){var e=Object(u.a)(["\n    height: 100vh;\n    width: 100%;\n"]);return j=function(){return e},e}var E=m.c.div(j()),S=m.c.div(O(),e=>e.theme.colors.colorBlueDark),M=m.c.div(x(),e=>e.theme.colors.colorBlueNavy),T=m.c.div(w(),e=>e.theme.colors.colorBlueNavy),L=m.c.div(v()),k=m.c.div(D()),y=m.c.div(g()),I=m.c.div(f()),C=m.c.div(b()),F=m.c.div(h()),A=m.c.div(p()),P=m.c.div(d()),z=a(565),N=a(7),Y=a(46),H=a(13);function R(e){var t=e.stations,a=e.match,i=e.dispatchSetLimiti,r=e.setLimiti,c=e.dispatchGetStationsList,l=e.updatedStations,s=e.dispatchChartDetails,u=e.firstChartData,m=e.secondChartData,d=e.history,p=(e.token,(d.location.pathname.match(/\d+\.\d+|\d+\b|\d+(?=\w)/g)||[]).map((function(e){return+e})).pop()),h=o.a.useState(l),b=Object(n.a)(h,2),f=b[0],g=b[1],D=o.a.useState(p-1),v=Object(n.a)(D,2),w=v[0],x=v[1],O=o.a.useState(!1),j=Object(n.a)(O,2),R=j[0],B=j[1],U=o.a.useState({}),V=Object(n.a)(U,2),G=V[0],J=V[1],K=o.a.useState(!1),Z=Object(n.a)(K,2),$=Z[0],W=Z[1],X=o.a.useState({}),_=Object(n.a)(X,2),q=_[0],Q=_[1],ee=o.a.useState({dateFrom:(new Date).setMonth((new Date).getMonth()-1),dateTo:(new Date).getTime()}),te=Object(n.a)(ee,2),ae=te[0],ne=te[1],ie=o.a.useState({dateFrom:(new Date).setMonth((new Date).getMonth()-1),dateTo:(new Date).getTime()}),oe=Object(n.a)(ie,2),re=oe[0],ce=oe[1],le=o.a.useState(!1),se=Object(n.a)(le,2),ue=se[0],me=se[1],de=o.a.useState(null),pe=Object(n.a)(de,2),he=pe[0],be=pe[1],fe=o.a.useState(null),ge=Object(n.a)(fe,2),De=ge[0],ve=ge[1],we=o.a.useState(!1),xe=Object(n.a)(we,2),Oe=xe[0],je=xe[1],Ee=o.a.useState(!1),Se=Object(n.a)(Ee,2),Me=Se[0],Te=Se[1],Le=o.a.useState(null),ke=Object(n.a)(Le,2),ye=ke[0],Ie=ke[1],Ce=o.a.useState(null),Fe=Object(n.a)(Ce,2),Ae=Fe[0],Pe=Fe[1],ze=o.a.useState(null),Ne=Object(n.a)(ze,2),Ye=Ne[0],He=Ne[1],Re=o.a.useState(null),Be=Object(n.a)(Re,2),Ue=Be[0],Ve=Be[1],Ge=o.a.useState([{uom:"-",label:"-",domain:[0,10]}]),Je=Object(n.a)(Ge,2),Ke=Je[0],Ze=Je[1],$e=o.a.useState([new Date((new Date).setHours((new Date).getHours()-1)),new Date]),We=Object(n.a)($e,2),Xe=We[0],_e=We[1],qe=o.a.useState([{uom:"-",label:"-",domain:[0,10]}]),Qe=Object(n.a)(qe,2),et=Qe[0],tt=Qe[1],at=o.a.useState([new Date((new Date).setHours((new Date).getHours()-1)),new Date]),nt=Object(n.a)(at,2),it=nt[0],ot=nt[1],rt=o.a.useState([]),ct=Object(n.a)(rt,2),lt=ct[0],st=ct[1],ut=o.a.useState(null),mt=Object(n.a)(ut,2),dt=mt[0],pt=mt[1],ht=o.a.useState(!1),bt=Object(n.a)(ht,2),ft=bt[0],gt=bt[1],Dt=o.a.useState(e.location.ridp?e.location.ridp:localStorage.getItem("RIDP")),vt=Object(n.a)(Dt,2),wt=vt[0],xt=(vt[1],localStorage.getItem("token"));if(e.location.ridp&&localStorage.setItem("RIDP",e.location.ridp),o.a.useEffect(()=>{localStorage.getItem("RIDP")},[wt]),!d.location.stationData){d.location.pathname;var Ot=d.location.pathname.substring(d.location.pathname.lastIndexOf("id=")+1,d.location.pathname.lastIndexOf("/")).substring(2),jt=t.find(e=>e.id===Ot);d.location.stationData=jt}var Et=o.a.useState(d.location.stationData.impiantoDiRiduzione.length),St=Object(n.a)(Et,1)[0],Mt=d.location.stationData,Tt=Mt.impiantoDiRiduzione[w],Lt=e=>{var t=e.map(e=>e.values.map(e=>Number(e.y))).filter(e=>e.length>0),a=t.map(e=>Math.max(...e)),n=t.map(e=>Math.min(...e)),i=Math.max(...a),o=Math.min(...n);return Math.abs(o)!==1/0&&Math.abs(i)!==1/0?[o,i]:[0,10]},kt=(e,t)=>{var a=new Date(e),n="toDDMMYYY+1"===t?a.getMonth()+1:a.getMonth();switch(n=n<10?"0"+n:n,t){case"toDDMMYYY+1":case"toDDMMYYY":return a.getDate()+"-"+n+"-"+a.getFullYear()}},yt=o.a.useCallback(e=>{var t=e.map(e=>e),a=[...new Set(t.map(e=>e.uom))],n=[];return a.forEach(e=>{n.push({uom:e,label:Object(H.h)(e),domain:Lt(t.filter(t=>t.uom===e))})}),{domain:n,newCurrentChart:t}},[]);o.a.useEffect(()=>{ue&&me(!1)},[ue]);var It=[],Ct=(e,t)=>{s({areaImpiantistica:Mt.id,codiceImpianto:Tt.name,startDate:kt(e,"toDDMMYYY+1"),endDate:kt(t,"toDDMMYYY+1")},xt)},Ft=(e,t,a,n,i,o)=>{((e,t,a)=>{var n=e&&e.dateFrom?new Date(e.dateFrom):new Date((new Date).setHours((new Date).getHours()-1)),i=e&&e.dateTo?new Date(e.dateTo):new Date;e.chart&&t(yt(e.chart).domain);a([n,i])})(e,t,a),o(((e,t)=>{var a=[];return e&&e.forEach(e=>{e.checked?(gt(!0),t.chart.forEach(t=>{e.value===t.name&&a.push(t)})):gt(!1)}),e&&a?[...a]:t&&t.chart?[...t.chart]:[]})(n,e)),i&&((e,t)=>{e.listParameters.forEach((e,a)=>{var n=Object(H.f)(lt,e.tag),i=Object(H.a)(e.uom,a),o=t.find(t=>t.name.split("_")[1]===e.tag);It.push({tag:e.tag,color:i,label:n.label,uom:e.uom}),o&&(o.color=i)})})(e,i)},At=()=>{J({}),W(!1),Q({}),ne({dateFrom:(new Date).setMonth((new Date).getMonth()-1),dateTo:(new Date).getTime()}),ce({dateFrom:(new Date).setMonth((new Date).getMonth()-1),dateTo:(new Date).getTime()}),me(!1),be(null),ve(null),je(!1),Te(!1),Ie(null),Pe(null),He(null),Ve(null),Ze([{uom:"-",label:"-",domain:[0,10]}]),_e([new Date((new Date).setHours((new Date).getHours()-1)),new Date]),tt([{uom:"-",label:"-",domain:[0,10]}]),ot([new Date((new Date).setHours((new Date).getHours()-1)),new Date]),st([]),pt(null)},Pt=(e,t,a,n,i)=>{e.dateFrom?(Ct(e.dateFrom,e.dateTo),t({dateFrom:"",dateTo:""}),je(!1),Te(!1)):a!==n&&(i(n),pt(null))};o.a.useEffect(()=>{ye?(Ft(ye,Ze,_e,he,Ye,He),Ft(Ae,tt,ot,De,Ue,Ve)):((()=>{At();var e=(new Date).setMonth((new Date).getMonth()-1),t=(new Date).getTime();Ct(e,t),pt(3)})(),u&&(Ie(u),Pe(m)))},[s,u,m,ye,Ae]),o.a.useEffect(()=>{1===dt?Pt(ae,ne,ye,u,Ie):2===dt?Pt(re,ce,Ae,m,Pe):3===dt&&u!==ye&&(Ie(u),Pe(m),pt(null))},[dt,u,m]),o.a.useEffect(()=>{he&&ue&&Ft(ye,Ze,_e,he,Ye,He),De&&ue&&Ft(Ae,tt,ot,De,Ue,Ve)},[he,De,ue]);Date.now();o.a.useEffect(()=>{$?(i({idMisuratore:G.idMisuratore,accettaLimiti:G.confirmed,noteLimiti:G.note?G.note:""},xt),W(!1)):r&&(()=>{if("OK"===r)B(!1),J({}),c(wt,xt),At();else if("KO"===r){var e={name:G.name,id:G.id,status:r};Q(e);var t=setTimeout(()=>{Q({})},5e3)}})()},[r,$,i,c]);var zt=(e,t)=>{if(1===t){if(he)return he;switch(e){case 0:return[{id:"1",name:"Portata",value:"Portata",checked:!0,color:"#596bee",action:e=>!e},{id:"2",name:"Limiti",value:"LimitiAttuali",checked:!0,color:"#ee7c59",action:e=>!e},{id:"3",name:"AI Tips",value:"LimitiSuggeriti",checked:!0,color:"#00d183",action:e=>!e}];case 1:return[{id:"1",name:"Nomine",value:"Nomina",checked:!0,color:"#ee598b",action:e=>!e},{id:"2",name:"Portata",value:"Portata",checked:!0,color:"#596bee",action:e=>!e},{id:"3",name:"Limiti",value:"LimitiAttuali",checked:!0,color:"#ee7c59",action:e=>!e}]}}else if(2===t){if(De)return De;switch(e){case 0:return[{id:"4",name:"Pressione Monte",value:"PressioneMonte",checked:!0,color:"#59deee",action:e=>!e},{id:"5",name:"Pressione Valle",value:"PressioneValle",checked:!0,color:"#016ee5",action:e=>!e}];case 1:return[{id:"4",name:"Pressione Valle",value:"PressioneValle",checked:!0,color:"#016ee5",action:e=>!e}]}}};return o.a.useEffect(()=>{l&&g(l)},[c,l]),o.a.createElement(E,null,o.a.createElement(S,null,o.a.createElement(M,null,o.a.createElement(z.c,{ridp:wt,onClickLogo:()=>d.push("/")})),o.a.createElement(T,null,o.a.createElement(L,null,o.a.createElement(N.c,{paths:1!==Mt.type?[{key:"Mappa Toscana",title:"Mappa Toscana",url:"/"},{key:"Stazione",title:Mt.name.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()).replace(/(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$|^\d/g,e=>e.toUpperCase()),url:a.url},{key:"Cabina",title:"CAB "+Tt.name,url:"#"}]:[{key:"Mappa Toscana",title:"Mappa Toscana",url:"/"},{key:"Stazione",title:Mt.name.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()).replace(/(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$|^\d/g,e=>e.toUpperCase()),url:a.url}],state:Mt.state,time:d.location.updateTime}),o.a.createElement(y,null,o.a.createElement(I,null,w+1," / ",St," "),o.a.createElement(N.b,{icon:"iconArrowBack",size:25,action:()=>{var e=w;e<1?e=St-1:e--,x(e),At()},inactive:St<=1}),o.a.createElement(N.b,{icon:"iconArrowForward",size:25,action:()=>{var e=w;e===St-1?e=0:e++,x(e),At()},inactive:St<=1}))),o.a.createElement(k,null,o.a.createElement(C,null,1!==Mt.type&&o.a.createElement(N.g,{title:"Pressione Monte",value:Tt.pressioneIN}),o.a.createElement(N.g,{title:"Pressione Valle",value:Tt.pressioneOUT}),1===Mt.type&&o.a.createElement(N.g,{title:"Nomina G/G MAX",value:Mt.valoreNomina}),o.a.createElement(N.g,{title:"Portata",value:Tt.portata}),o.a.createElement(N.g,{title:"Limite",value:Tt.limite}),((e,t)=>(f&&(t=(e=f.find(t=>e.id===t.id)).impiantoDiRiduzione[w]),e.notification&&t.limiteConsigliato>0&&1!=e.state))(Mt,Tt)&&o.a.createElement(N.g,{title:"Limite consigliato HH",value:Tt,stationName:Mt.name,actionLimitModal:(e,t,a)=>{var n={name:t,cabin:e.name,date:e.limitDate,id:e.id,idMisuratore:e.idMisuratore,confirmed:a,note:""};J(n),"NO"===n.confirmed?B(!0):W(!0)},confirmLimits:q,confirmLimitsAction:Q})),o.a.createElement(Y.s,{showModal:R,onClose:()=>B(!1),maxWidth:"680px",setLimiti:G,setLimitiAction:W,changesetLimiti:J,confirmLimits:q,confirmLimitsAction:Q}),o.a.createElement(F,null,1===Mt.type&&o.a.createElement(P,null," NOMINE / PORTATE / LIMITI"),1!==Mt.type&&o.a.createElement(P,null," PORTATE / LIMITI / LIMITI CONSIGLIATI"),ye&&o.a.createElement(Y.j,{classStyle:"",padding:"15px 0",filters:{dateFrom:ye.dateFrom?ye.dateFrom:ae.dateFrom,dateTo:ye.dateTo?ye.dateTo:ae.dateTo,checkbox:zt(Mt.type,1)},changeDateFilters:ne,changeCheckboxFilters:be,updateDate:()=>pt(1),update:ue,updateAction:me,zoom:Oe,zoomAction:()=>{je(!Oe)}}),o.a.createElement(A,null,Ye&&o.a.createElement(Y.h,{zoomActive:Oe,onChangeZoomActive:()=>{je(!1)},chartFiltered:ft,idSelector:"#cartesian-trend-modal-BO-3-1586551935",data:Ye,height:222,xDomain:Xe,yDomain:Ke,xLabel:"t",xUnit:"t",margin:{top:32,right:32,bottom:20,left:20},colors:H.a,findTooltipLabel:e=>Object(H.d)(lt,e)}))),o.a.createElement(F,null,0!==Mt.type&&o.a.createElement(P,null,"PRESSIONE VALLE"),0===Mt.type&&o.a.createElement(P,null,"PRESSIONI MONTE & VALLE"),Ae&&o.a.createElement(Y.j,{classStyle:"",padding:"15px 0",filters:{dateFrom:Ae.dateFrom?Ae.dateFrom:re.dateFrom,dateTo:Ae.dateTo?Ae.dateTo:re.dateTo,checkbox:zt(Mt.type,2)},changeDateFilters:ce,changeCheckboxFilters:ve,updateDate:()=>pt(2),update:ue,updateAction:me,zoom:Me,zoomAction:()=>{Te(!Me)}}),o.a.createElement(A,null,Ue&&o.a.createElement(Y.h,{zoomActive:Me,onChangeZoomActive:()=>{Te(!1)},idSelector:"#cartesian-trend-modal-BO-3-1586551934",data:Ue,height:222,xDomain:it,yDomain:et,xLabel:"t",xUnit:"t",margin:{top:32,right:32,bottom:20,left:20},colors:H.a,findTooltipLabel:e=>Object(H.d)(lt,e)})))))))}R.propType={},R.defaultProps={};t.default=Object(r.b)(e=>({setLimiti:e.limiti.setLimiti,updatedStations:e.stationsList.stations,firstChartData:e.chartDetails.firstChartData,secondChartData:e.chartDetails.secondChartData}),e=>({dispatchGetStationsList:(t,a)=>e(Object(c.e)(t,a)),dispatchSetLimiti:(t,a)=>e(Object(l.d)(t,a)),dispatchChartDetails:(t,a)=>e(Object(s.d)(t,a))}))(R)}}]);