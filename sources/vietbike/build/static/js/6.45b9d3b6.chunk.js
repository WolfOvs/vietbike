(this.webpackJsonproot=this.webpackJsonproot||[]).push([[6],{571:function(t,i,e){"use strict";e.r(i);var a=e(8),n=e(0),o=e.n(n),s=e(90),r=e(46),c=e(2),l=e(1);function d(){var t=Object(c.a)(["\n\twidth:18px;\n\theight:18px;\n\tbackground-color: red;\n\tdisplay:block;\n\tposition:absolute;\n\tborder-radius:100%;\n\ttext-align:center;\n\tright:30px;\n\tfont-size: 11px;\n\tfont-weight: bold;\n\n\tspan {\n\t\tpadding-top: 2px;\n\t\tpadding-right: 1px;\n\t\tdisplay: block;\n\t}\n"]);return d=function(){return t},t}function m(){var t=Object(c.a)(["\n\tdisplay: flex;\n\tjustify-content: space-between;\n\tpadding-bottom: 25px;\n"]);return m=function(){return t},t}function u(){var t=Object(c.a)(["\n\tposition: absolute;\n\twidth: 100%;\n\ttop: 37px;\n\tleft: 0;\n\tz-index: ",";\n\tjustify-content: flex-end;\n\tbackground: ",";\n\tbox-shadow: 0 0 5px 0 ",";\n\t@media(max-width: ",") {\n\t\tjustify-content: flex-start;\n\t}\n"]);return u=function(){return t},t}l.c.div(u(),t=>t.theme.zIndex.xl,t=>t.theme.colors.white,t=>t.theme.colors.shadow,t=>t.theme.constants.BREAKPOINT_MOBILE);var p=l.c.div(m()),f=l.c.div(d()),v=e(565),g=e(52),h=e(70);var S={map:[{id:"suggestedLimit",name:"Limite consigliato",value:!0},{id:"primaryNetwork",name:"Rete primaria",value:!0},{id:"secondaryNetwork",name:"Rete secondaria",value:!0},{id:"flowRate",name:"Flusso portata",value:!0},{id:"districtBoundary",name:"Confini di distretto",value:!0},{id:"regionBoundary",name:"Confini di regione",value:!0},{id:"centerBoundary",name:"Confini di centro",value:!0}],notifications:[{id:"Entry point",name:"Entry point",value:!0},{id:"Giornalieri",name:"Giornalieri",value:!0},{id:"Settimanali",name:"Settimanali",value:!0},{id:"Mensili",name:"Mensili",value:!0},{id:"Stagionali",name:"Stagionali",value:!0}]};function b(t){var i=t.stations,e=t.match,n=t.title,s=(t.token,t.pipelines),c=t.centers,l=t.dispatchSetLimiti,d=t.setLimiti,m=t.dispatchGetStationsList,u=t.updatedStations,g=o.a.useState(!1),h=Object(a.a)(g,2),b=(h[0],h[1],function(t){var i=o.a.useState(t),e=Object(a.a)(i,2),n=e[0],s=e[1];return[n,function(t){"Stoccaggio"===t&&s({stoccaggio:!n.stoccaggio,spinta:n.spinta}),"Spinta"===t&&s({stoccaggio:n.stoccaggio,spinta:!n.spinta})}]}({stoccaggio:!0,spinta:!0})),x=Object(a.a)(b,2),O=x[0],j=(x[1],o.a.useState(!1)),L=Object(a.a)(j,2),w=L[0],y=L[1],E=o.a.useState(!1),M=Object(a.a)(E,2),k=M[0],I=M[1],R=o.a.useState(!1),C=Object(a.a)(R,2),N=C[0],z=C[1],B=o.a.useState(!1),D=Object(a.a)(B,2),A=D[0],G=D[1],P=o.a.useState(S),F=Object(a.a)(P,2),K=F[0],T=F[1],W=o.a.useState("0,1,2,3,4"),q=Object(a.a)(W,2),J=q[0],_=q[1],H=o.a.useState(!1),Q=Object(a.a)(H,2),U=Q[0],V=Q[1],X=[],Y=o.a.useState(s),Z=Object(a.a)(Y,2),$=Z[0],tt=Z[1],it=o.a.useState(i),et=Object(a.a)(it,2),at=et[0],nt=et[1],ot=o.a.useState({}),st=Object(a.a)(ot,2),rt=st[0],ct=st[1],lt=o.a.useState([]),dt=Object(a.a)(lt,2),mt=dt[0],ut=dt[1],pt=o.a.useState({}),ft=Object(a.a)(pt,2),vt=ft[0],gt=ft[1],ht=o.a.useState(!1),St=Object(a.a)(ht,2),bt=St[0],xt=St[1],Ot=o.a.useState({}),jt=Object(a.a)(Ot,2),Lt=jt[0],wt=jt[1],yt=o.a.useState(new Date),Et=Object(a.a)(yt,2),Mt=Et[0],kt=(Et[1],o.a.useState(t.location.ridp?t.location.ridp:localStorage.getItem("RIDP"))),It=Object(a.a)(kt,2),Rt=It[0],Ct=(It[1],localStorage.getItem("token"));t.location.ridp&&localStorage.setItem("RIDP",t.location.ridp),o.a.useEffect(()=>{localStorage.getItem("RIDP")},[Rt]);o.a.useEffect(()=>{setInterval((function(){m(Rt,Ct)}),6e5),bt?(V(!1),l({idMisuratore:vt.idMisuratore,accettaLimiti:vt.confirmed,noteLimiti:vt.note?vt.note:""},Ct),xt(!1)):d&&(()=>{if("OK"===d)z(!1),gt({}),m(Rt,Ct);else if("KO"===d){var t={name:vt.name,id:vt.id,status:d};wt(t);var i=setTimeout(()=>{wt({})},5e3)}})()},[d,bt,l,m]);var Nt=()=>{y(!w)},zt=t=>{var i=[];(console.log(K),(t=>{var i=[{id:"primaryNetwork",value:"4"},{id:"secondaryNetwork",value:"3"},{id:"districtBoundary",value:"2"},{id:"regionBoundary",value:"1"},{id:"centerBoundary",value:"0"}];K.map.map(e=>{i.map(i=>{e.id===i.id&&(e.value?t.push(i.value):t.filter(t=>t!==i.value))})})})(i),K.map[0].value)?document.querySelector("#map").classList.remove("noNotification"):document.querySelector("#map").classList.add("noNotification");K.map[3].value?tt(s):tt([]),K.notifications.forEach(t=>{(t=>{var i=[];[{id:"Entry point",time:"EP"},{id:"Giornalieri",time:"Giornaliero"},{id:"Settimanali",time:"Settimanale"},{id:"Mensili",time:"Mensile"},{id:"Stagionali",time:"Stagionale"}].map(e=>{t.id===e.id&&at.map(t=>{var a=t.impiantoDiRiduzione.filter(t=>t.limiteConsigliato&&t.time===e.time);if(t.notification&&1!==t.state&&a.length>0){var n={name:t.name,id:t.id,notification:t.notification,state:t.state,impiantoDiRiduzione:t.impiantoDiRiduzione.filter(t=>t.limiteConsigliato&&t.time===e.time)};i.push(n)}})}),t.value?(X.push(i),ut([...mt,...i])):X.filter(t=>t!==i)})(t)});var e=i.join(","),a=[].concat(...X).filter((function(t){return void 0!==t}));ut(a),V(!0),_(e),G(!A),T(t),I(!1)},Bt=null;i.forEach(t=>{t.notification&&1!==t.state&&t.impiantoDiRiduzione.map(t=>{t.limiteConsigliato&&Bt++})});var Dt=(t,i,e)=>{var a={name:i,cabin:t.name,date:t.limitDate,id:t.id,idMisuratore:t.idMisuratore,confirmed:e,note:""};gt(a),"NO"===a.confirmed?z(!0):xt(!0)};return o.a.useEffect(()=>{u&&(ct(u),nt(u))},[m,u]),o.a.createElement(v.b,{stations:mt&&U?mt:at,pageCurrent:e,isOpenNotification:w,actionNotification:Nt,notificationCount:Bt,ridp:Rt,showModalAction:Dt,confirmLimits:Lt,confirmLimitsAction:wt},o.a.createElement(r.d,null,o.a.createElement(r.c,{paths:[{key:"Set Limiti",title:n,url:e.url}],time:Mt}),o.a.createElement(p,null,o.a.createElement(r.e,{text:"Filtra",icon:"iconFilter",sizeIcon:30,height:"42px",padding:"0px 5px 0px 10px",width:"120px",action:()=>I(!0)}),Bt>0&&!w&&o.a.createElement(f,null,o.a.createElement("span",null,Bt)),!w&&o.a.createElement(r.e,{shake:Bt>0,icon:"iconBell",sizeIcon:30,height:"42px",width:"42px",padding:"0px 10px",action:Nt}))),o.a.createElement(r.s,{showModal:k,onClose:()=>I(!1),maxWidth:"840px",refresh:A,maxWidth:"800px",filters:K,toggleAction:(t,i,e)=>{var a=K;a[i].map(i=>{i.name===t&&(i.value=!e)}),G(!A),T(a)},cancel:t=>{V(!1),((t,i)=>{var e=K;e.map.map(t=>{t.value=!0}),e.notifications.map(t=>{t.value=!0}),G(!A),T(e)})(),zt(t)},confirm:zt}),o.a.createElement(r.s,{showModal:N,onClose:()=>z(!1),maxWidth:"680px",setLimiti:vt,setLimitiAction:xt,changesetLimiti:gt,confirmLimits:Lt,confirmLimitsAction:wt}),o.a.createElement(v.a,{stations:i,updatedStations:rt,stationsMap:$,filterMap:J,filterOptions:K,filters:O,showModalAction:Dt,pipelines:s,centers:c,confirmLimits:Lt,confirmLimitsAction:wt,updateInfoTime:Mt,filterState:U}))}b.defaultProps={stations:{},side:"left"};i.default=Object(s.b)(t=>({setLimiti:t.limiti.setLimiti,updatedStations:t.stationsList.stations}),t=>({dispatchSetLimiti:(i,e)=>t(Object(h.d)(i,e)),dispatchGetStationsList:(i,e)=>t(Object(g.e)(i,e))}))(b)}}]);